var p=function(u){const i=O;O=[];const n=u();return O=i,n};function q(u){const i=new M(u);return Object.assign(i.get.bind(i),{set:i.set.bind(i),map:(n)=>i.set(n(i.get()))})}function r(u){new o(u)}function z(u){const i=new M(null);return new o(()=>{i.set(u(p))}),i.get.bind(i)}var O=[];class o{callback;constructor(u){this.callback=u,this.run()}run(){O.push(this),this.callback(p),O.pop()}}class M{value;deps;constructor(u){this.value=u,this.deps=[]}sub(u){if(!this.deps.includes(u))this.deps.push(u)}pub(){for(let u of this.deps)u.run()}get(){const u=O.at(-1);return u&&this.sub(u),this.value}set(u){if(u!==this.value)this.value=u,this.pub()}}function y(u){return u[b]==="text"}var b=Symbol();function L(u,i,n){return{[b]:u,props:i,children:n}}var Q=new Proxy(Object.prototype,{get(u,i){return(...n)=>{if(i!=="text"&&n.length>0){const H=n[0];if(typeof H==="object"&&H!==null&&typeof H[b]==="undefined")return L(i,H,n.slice(1))}return L(i,{},n)}}});var D=function(u,i,n){const H=Array.isArray(n)?n:[n];for(let t of H)if(typeof t==="function")u.addEventListener(i,t);else u.addEventListener(i,t.handler,t.options)},w=function(u,i,n){if(typeof n==="string"||typeof n==="number")u.setAttribute(i,`${n}`);else if(n===!0)u.setAttribute(i,"");else u.removeAttribute(i)},j=function(u){if(u.children.length===0)return document.createTextNode("");const i=u.children.map((H)=>{if(typeof H!=="function")return document.createTextNode(`${H}`);const t=document.createTextNode("");return r(()=>t.replaceData(0,t.length,`${H()}`)),t});if(i.length===1)return i[0];const n=document.createElement("span");return n.append(...i),n};function U(u){if(y(u))return j(u);const i=document.createElement(u[b]);for(let[n,H]of Object.entries(u.props))if(n.startsWith(m))D(i,n.slice(m.length),H);else if(typeof H!=="function")w(i,n,H);else r(()=>{w(i,n,H())});for(let n of u.children)if(typeof n==="object")n&&i.appendChild(U(n));else if(typeof n!=="undefined"&&typeof n!=="boolean")i.appendChild(document.createTextNode(`${n}`));return i}var m="on";export{q as signal,U as render,L as h,r as effect,z as derived,Q as TAGS};
