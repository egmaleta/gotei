var m=function(u){const i=r;r=[];const n=u();return r=i,n};function $(u){const i=new b(u),n=(t)=>{if(t instanceof Function)i.set(t(i.get()));else i.set(t)};return[i.get.bind(i),n]}function M(u){new o(u)}function q(u){const i=new b(null);return new o(()=>{i.set(u(m))}),i.get.bind(i)}var r=[];class o{callback;constructor(u){this.callback=u,this.run()}run(){r.push(this),this.callback(m),r.pop()}}class b{value;deps;constructor(u){this.value=u,this.deps=[]}sub(u){if(!this.deps.includes(u))this.deps.push(u)}pub(){for(let u of this.deps)u.run()}get(){const u=r.at(-1);return u&&this.sub(u),this.value}set(u){if(u!==this.value)this.value=u,this.pub()}}function p(u){return u[O]==="text"}var O=Symbol();function y(u,i,n){return{[O]:u,props:i,children:n}}var Q=new Proxy(Object.prototype,{get(u,i){return(...n)=>{if(i!=="text"&&n.length>0){const t=n[0];if(typeof t==="object"&&t!==null&&typeof t[O]==="undefined")return y(i,t,n.slice(1))}return y(i,{},n)}}});var D=function(u,i,n){const t=Array.isArray(n)?n:[n];for(let H of t)if(typeof H==="function")u.addEventListener(i,H);else u.addEventListener(i,H.handler,H.options)},w=function(u,i,n){if(typeof n==="string"||typeof n==="number")u.setAttribute(i,`${n}`);else if(n===!0)u.setAttribute(i,"");else u.removeAttribute(i)},j=function(u){if(u.children.length===0)return document.createTextNode("");const i=u.children.map((t)=>{if(typeof t!=="function")return document.createTextNode(`${t}`);const H=document.createTextNode("");return M(()=>H.replaceData(0,H.length,`${t()}`)),H});if(i.length===1)return i[0];const n=document.createElement("span");return n.append(...i),n};function U(u){if(p(u))return j(u);const i=document.createElement(u[O]);for(let[n,t]of Object.entries(u.props))if(n.startsWith(L))D(i,n.slice(L.length),t);else if(typeof t!=="function")w(i,n,t);else M(()=>{w(i,n,t())});for(let n of u.children)if(typeof n==="object")n&&i.appendChild(U(n));else if(typeof n!=="undefined"&&typeof n!=="boolean")i.appendChild(document.createTextNode(`${n}`));return i}var L="on";export{$ as signal,U as render,y as h,M as effect,q as derived,Q as TAGS};
