var y=function(u){const i=b;b=[];const O=u();return b=i,O};function m(u){const i=new o(u),O=(t)=>{if(typeof t==="function")i.set(t(i.get()));else i.set(t)};return[i.get.bind(i),O]}function H(u){new M(u)}function n(u){const i=new o(null);return new M(()=>{i.set(u(y))}),i.get.bind(i)}var b=[];class M{callback;constructor(u){this.callback=u,this.run()}run(){b.push(this),this.callback(y),b.pop()}}class o{value;deps;constructor(u){this.value=u,this.deps=[]}sub(u){if(!this.deps.includes(u))this.deps.push(u)}pub(){for(let u of this.deps)u.run()}get(){const u=b.at(-1);return u&&this.sub(u),this.value}set(u){if(u!==this.value)this.value=u,this.pub()}}function r(u){return u[d]==="text"}var d=Symbol();function s(u,i,O){return{[d]:u,props:i,children:O}}var $=new Proxy(Object.prototype,{get(u,i){return(...O)=>{if(i!=="text"&&O.length>0){const t=O[0];if(typeof t==="object"&&t!==null&&typeof t[d]==="undefined")return s(i,t,O.slice(1))}return s(i,{},O)}}});var C=function(u,i,O){const t=Array.isArray(O)?O:[O];for(let p of t)if(typeof p==="function")u.addEventListener(i,p);else u.addEventListener(i,p.handler,p.options)},A=function(u,i,O){if(typeof O==="string"||typeof O==="number")u.setAttribute(i,`${O}`);else if(O===!0)u.setAttribute(i,"");else u.removeAttribute(i)},D=function(u){if(u.children.length===0)return document.createTextNode("");const i=u.children.map((t)=>{if(typeof t!=="function")return document.createTextNode(`${t}`);const p=document.createTextNode("");return H(()=>p.replaceData(0,p.length,`${t()}`)),p});if(i.length===1)return i[0];const O=document.createElement("span");return O.append(...i),O};function j(u){if(r(u))return D(u);const i=document.createElement(u[d]);for(let[O,t]of Object.entries(u.props))if(O.startsWith(L))C(i,O.slice(L.length),t);else if(typeof t!=="function")A(i,O,t);else H(()=>{A(i,O,t())});for(let O of u.children)if(typeof O==="object")O&&i.appendChild(j(O));else if(typeof O!=="undefined"&&typeof O!=="boolean")i.appendChild(document.createTextNode(`${O}`));return i}var L="on";export{m as signal,j as render,s as h,H as effect,n as derived,$ as TAGS};
