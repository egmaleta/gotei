function m(u){const r=new O(u);return[r.get.bind(r),r.set.bind(r)]}function s(u){new H(u)}function w(u){const r=new O(null);return new H(()=>{r.set(u())}),r.get.bind(r)}function y(u){const r=i;i=[];const n=u();return i=r,n}var i=[];class H{callback;constructor(u){this.callback=u,this.run()}run(){i.push(this),this.callback(),i.pop()}}class O{value;deps;constructor(u){this.value=u,this.deps=[]}sub(u){if(!this.deps.includes(u))this.deps.push(u)}pub(){for(let u of this.deps)u.run()}get(){const u=i.at(-1);return u&&this.sub(u),this.value}set(u){if(u!==this.value)this.value=u,this.pub()}}function d(u,r,n){return{tag:u,props:r,children:n}}function U(u){return{tag:"text",children:u}}var V=new Proxy(Object.prototype,{get(u,r){return function(n,...o){return d(r,n,o)}}});function b(u){return u.tag==="text"}var g=function(u,r,n){const o=Array.isArray(n)?n:[n];for(let p of o)if(typeof p==="function")u.addEventListener(r,p);else u.addEventListener(r,p.handler,p.options)},M=function(u,r,n){if(typeof n==="string"||typeof n==="number")u.setAttribute(r,`${n}`);else if(n===!0)u.setAttribute(r,"");else u.removeAttribute(r)},t=function(u){const{children:r}=u;if(typeof r!=="function")return document.createTextNode(`${r}`);const n=document.createTextNode("");return s(()=>{n.replaceData(0,n.length,`${r()}`)}),n};function L(u){if(b(u))return t(u);const r=document.createElement(u.tag);for(let[n,o]of Object.entries(u.props))if(n.startsWith(A))g(r,n.slice(A.length),o);else if(typeof o!=="function")M(r,n,o);else s(()=>{M(r,n,o())});for(let n of u.children)if(typeof n==="object")n&&r.appendChild(L(n));else if(typeof n!=="undefined"&&typeof n!=="boolean")r.appendChild(document.createTextNode(`${n}`));return r}var A="on";export{U as text,V as tags,m as signal,L as render,y as peek,d as h,s as effect,w as derived};
