var o=function(u){const n=H;H=[];const i=u();return H=n,i};function T(u){const n=new M(u);return[n.get.bind(n),n.set.bind(n)]}function b(u){new O(u)}function U(u){const n=new M(null);return new O(()=>{n.set(u(o))}),n.get.bind(n)}var H=[];class O{callback;constructor(u){this.callback=u,this.run()}run(){H.push(this),this.callback(o),H.pop()}}class M{value;deps;constructor(u){this.value=u,this.deps=[]}sub(u){if(!this.deps.includes(u))this.deps.push(u)}pub(){for(let u of this.deps)u.run()}get(){const u=H.at(-1);return u&&this.sub(u),this.value}set(u){if(u!==this.value)this.value=u,this.pub()}}function L(u,n,i){return{tag:u,props:n,children:i}}var q=new Proxy(Object.prototype,{get(u,n){if(n==="text")return(...i)=>L(n,{},i);return(i,...t)=>L(n,i,t)}});function m(u){return u.tag==="text"}var A=function(u,n,i){const t=Array.isArray(i)?i:[i];for(let r of t)if(typeof r==="function")u.addEventListener(n,r);else u.addEventListener(n,r.handler,r.options)},p=function(u,n,i){if(typeof i==="string"||typeof i==="number")u.setAttribute(n,`${i}`);else if(i===!0)u.setAttribute(n,"");else u.removeAttribute(n)},w=function(u){if(u.children.length===0)return document.createTextNode("");const n=u.children.map((t)=>{if(typeof t!=="function")return document.createTextNode(`${t}`);const r=document.createTextNode("");return b(()=>r.replaceData(0,r.length,`${t()}`)),r});if(n.length===1)return n[0];const i=document.createElement("span");return i.append(...n),i};function D(u){if(m(u))return w(u);const n=document.createElement(u.tag);for(let[i,t]of Object.entries(u.props))if(i.startsWith(y))A(n,i.slice(y.length),t);else if(typeof t!=="function")p(n,i,t);else b(()=>{p(n,i,t())});for(let i of u.children)if(typeof i==="object")i&&n.appendChild(D(i));else if(typeof i!=="undefined"&&typeof i!=="boolean")n.appendChild(document.createTextNode(`${i}`));return n}var y="on";export{q as tags,T as signal,D as render,L as h,b as effect,U as derived};
