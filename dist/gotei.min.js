function D(u){const n=new M(u);return[n.get.bind(n),n.set.bind(n)]}function b(u){new O(u)}function T(u){const n=new M(null);return new O(()=>{n.set(u())}),n.get.bind(n)}function U(u){const n=H;H=[];const i=u();return H=n,i}var H=[];class O{callback;constructor(u){this.callback=u,this.run()}run(){H.push(this),this.callback(),H.pop()}}class M{value;deps;constructor(u){this.value=u,this.deps=[]}sub(u){if(!this.deps.includes(u))this.deps.push(u)}pub(){for(let u of this.deps)u.run()}get(){const u=H.at(-1);return u&&this.sub(u),this.value}set(u){if(u!==this.value)this.value=u,this.pub()}}function o(u,n,i){return{tag:u,props:n,children:i}}var q=new Proxy(Object.prototype,{get(u,n){if(n==="text")return(...i)=>o(n,{},i);return(i,...t)=>o(n,i,t)}});function L(u){return u.tag==="text"}var p=function(u,n,i){const t=Array.isArray(i)?i:[i];for(let r of t)if(typeof r==="function")u.addEventListener(n,r);else u.addEventListener(n,r.handler,r.options)},y=function(u,n,i){if(typeof i==="string"||typeof i==="number")u.setAttribute(n,`${i}`);else if(i===!0)u.setAttribute(n,"");else u.removeAttribute(n)},A=function(u){if(u.children.length===0)return document.createTextNode("");const n=u.children.map((t)=>{if(typeof t!=="function")return document.createTextNode(`${t}`);const r=document.createTextNode("");return b(()=>r.replaceData(0,r.length,`${t()}`)),r});if(n.length===1)return n[0];const i=document.createElement("span");return i.append(...n),i};function w(u){if(L(u))return A(u);const n=document.createElement(u.tag);for(let[i,t]of Object.entries(u.props))if(i.startsWith(m))p(n,i.slice(m.length),t);else if(typeof t!=="function")y(n,i,t);else b(()=>{y(n,i,t())});for(let i of u.children)if(typeof i==="object")i&&n.appendChild(w(i));else if(typeof i!=="undefined"&&typeof i!=="boolean")n.appendChild(document.createTextNode(`${i}`));return n}var m="on";export{q as tags,D as signal,w as render,U as peek,o as h,b as effect,T as derived};
