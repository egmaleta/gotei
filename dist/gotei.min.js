var y=function(u){const i=t;t=[];const n=u();return t=i,n};function $(u){const i=new m(u),n=(H)=>{if(typeof H==="function")i.set(H(i.get()));else i.set(H)};return[i.get.bind(i),n]}function o(u){new p(u)}function q(u){const i=new m(null);return new p(()=>{i.set(u(y))}),i.get.bind(i)}var t=[];class p{callback;constructor(u){this.callback=u,this.run()}run(){t.push(this),this.callback(y),t.pop()}}class m{value;deps;constructor(u){this.value=u,this.deps=[]}sub(u){if(!this.deps.includes(u))this.deps.push(u)}pub(){for(let u of this.deps)u.run()}get(){const u=t.at(-1);return u&&this.sub(u),this.value}set(u){if(u!==this.value)this.value=u,this.pub()}}function O(u){return u[M]==="text"}var M=Symbol();function r(u,i,n){return{[M]:u,props:i,children:n}}var Q=new Proxy(Object.prototype,{get(u,i){return(...n)=>{if(i!=="text"&&n.length>0){const H=n[0];if(typeof H==="object"&&H!==null&&typeof H[M]==="undefined")return r(i,H,n.slice(1))}return r(i,{},n)}}});var D=function(u,i,n){const H=Array.isArray(n)?n:[n];for(let b of H)if(typeof b==="function")u.addEventListener(i,b);else u.addEventListener(i,b.handler,b.options)},w=function(u,i,n){if(typeof n==="string"||typeof n==="number")u.setAttribute(i,`${n}`);else if(n===!0)u.setAttribute(i,"");else u.removeAttribute(i)},j=function(u){if(u.children.length===0)return document.createTextNode("");const i=u.children.map((H)=>{if(typeof H!=="function")return document.createTextNode(`${H}`);const b=document.createTextNode("");return o(()=>b.replaceData(0,b.length,`${H()}`)),b});if(i.length===1)return i[0];const n=document.createElement("span");return n.append(...i),n};function U(u){if(O(u))return j(u);const i=document.createElement(u[M]);for(let[n,H]of Object.entries(u.props))if(n.startsWith(L))D(i,n.slice(L.length),H);else if(typeof H!=="function")w(i,n,H);else o(()=>{w(i,n,H())});for(let n of u.children)if(typeof n==="object")n&&i.appendChild(U(n));else if(typeof n!=="undefined"&&typeof n!=="boolean")i.appendChild(document.createTextNode(`${n}`));return i}var L="on";export{$ as signal,U as render,r as h,o as effect,q as derived,Q as TAGS};
